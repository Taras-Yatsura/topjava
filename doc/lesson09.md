<article class="markdown-body entry-content container-lg" itemprop="text">
    <h1>
        <a id="user-content-онлайн-проект-topjava" class="anchor" aria-hidden="true" href="#онлайн-проект-topjava">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Онлайн-проект <a href="https://github.com/JavaWebinar/topjava">TopJava</a>
    </h1>
    <h2>
        <a id="user-content-материалы-занятия" class="anchor" aria-hidden="true" href="#материалы-занятия">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a href="https://drive.google.com/drive/folders/0B9Ye2auQ_NsFVWRGbEw1RjJrMjg" rel="nofollow">Материалы занятия</a>
    </h2>
    <ul>
        <li><strong>Браузер кэширует javascript и css. Если изменения не работают, обновите приложение в браузере по Ctrl+F5</strong></li>
        <li><strong>При удалении файлов не забывайте делать clean: <code>mvn clean package</code></strong></li>
    </ul>
    <h3>
        <a id="user-content--правки-в-проекте" class="anchor" aria-hidden="true" href="#-правки-в-проекте">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672935/ef09ec1e-e6e7-11e5-9f79-d1641c05cbe6.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672935/ef09ec1e-e6e7-11e5-9f79-d1641c05cbe6.png" alt="correction" style="max-width:100%;"></a> Правки в проекте
    </h3>
    <h4>
        <a id="user-content-apply-9_0_fixpatch" class="anchor" aria-hidden="true" href="#apply-9_0_fixpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_0_fix.patch
    </h4>
    <ul>
        <li>Старый стандарт HTML, HTML4, требовал наличия этого атрибута в теге &lt;script&gt;. Обычно он имел значение type="text/javascript". На текущий момент этого больше не требуется. Более того, в современном стандарте HTML смысл этого атрибута полностью изменился, теперь он может использоваться для JavaScript-модулей.
            <a href="https://learn.javascript.ru/hello-world" rel="nofollow">Тег «script»</a>
        </li>
        <li>Обновил заголовок <code>pom.xml</code></li>
    </ul>
    <h2>
        <a id="user-content--разбор-домашнего-задания-hw8" class="anchor" aria-hidden="true" href="#-разбор-домашнего-задания-hw8">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672719/09593080-e6e7-11e5-81d1-5cb629c438ca.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672719/09593080-e6e7-11e5-81d1-5cb629c438ca.png" alt="hw" style="max-width:100%;"></a> Разбор домашнего задания HW8
    </h2>
    <h3>
        <a id="user-content--1-hw8--optional-23" class="anchor" aria-hidden="true" href="#-1-hw8--optional-23">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 1. <a href="https://drive.google.com/file/d/1ZxmXrhz3K4V-mLkOOrH-JVtl5x0KSpIj" rel="nofollow">HW8 + Optional 2,3</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_01_hw8patch" class="anchor" aria-hidden="true" href="#apply-9_01_hw8patch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_01_HW8.patch
    </h4>
    <ul>
        <li><a href="https://getbootstrap.com/docs/4.1/layout/grid/" rel="nofollow">Grid system</a></li>
        <li><a href="https://stackoverflow.com/a/19865627/548473" rel="nofollow">Difference among col-* in Bootstrap</a></li>
        <li><a href="https://getbootstrap.com/docs/4.1/components/forms/" rel="nofollow">Bootstrap forms</a></li>
    </ul>
    <h4>
        <a id="user-content--вопрос" class="anchor" aria-hidden="true" href="#-вопрос">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png" alt="question" style="max-width:100%;"></a> Вопрос:
    </h4>
    <blockquote>
        <p>Можно ли было удаление делать без перезагрузки таблицы (удалением строки) и для редактирования брать данные со страницы, а не с сервера?</p>
    </blockquote>
    <p>В многопользовательском приложении принято при изменении данных подтягивать все изменения с базы, иначе может быть несогласованность базы и UI (например когда пользователей редактируют несколько администраторов одновременно). Для еды доставать из базы данные при редактировании нет необходимости, но лучше делать все универсально. В таблице обычно представлены не все данные, которые можно редактировать. Дополнительная нагрузка на базу тут совсем небольшая. Для еды нам при каждом добавлении-удалении-редактировании еще необходимо пересчитывать превышение excess.</p>
    <h4>
        <a id="user-content-apply-9_02_hw8_clear_filterpatch" class="anchor" aria-hidden="true" href="#apply-9_02_hw8_clear_filterpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_02_HW8_clear_filter.patch
    </h4>
    <h3>
        <a id="user-content--2-hw8-optional-enabledisable" class="anchor" aria-hidden="true" href="#-2-hw8-optional-enabledisable">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 2. <a href="https://drive.google.com/file/d/1-2ekRtwd60Cbqq4LPEQ_MOsqWcR7d04a" rel="nofollow">HW8 Optional: enable/disable</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_03_hw8_enable_disablepatch" class="anchor" aria-hidden="true" href="#apply-9_03_hw8_enable_disablepatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_03_HW8_enable_disable.patch
    </h4>
    <h2>
        <a id="user-content-занятие-9" class="anchor" aria-hidden="true" href="#занятие-9">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Занятие 9:
    </h2>
    <h3>
        <a id="user-content--3--spring-binding" class="anchor" aria-hidden="true" href="#-3--spring-binding">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 3.  <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFYlRkc2NGRGVydk0" rel="nofollow">Spring Binding</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_04_bindingpatch" class="anchor" aria-hidden="true" href="#apply-9_04_bindingpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_04_binding.patch
    </h4>
    <blockquote>
        <p>Перенес <code>ru.javawebinar.topjava.util.MealsUtil.DEFAULT_CALORIES_PER_DAY</code> в <code>ru.javawebinar.topjava.util.UserUtil</code></p>
    </blockquote>
    <h3>
        <a id="user-content--4--реализация-update" class="anchor" aria-hidden="true" href="#-4--реализация-update">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 4.  <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFd2ZvcS1pSjdMQlU" rel="nofollow">Реализация update</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_05_updatepatch" class="anchor" aria-hidden="true" href="#apply-9_05_updatepatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_05_update.patch
    </h4>
    <blockquote>
        <ul>
            <li>Сделал интерфейс <code>HasId</code> от которого наследуются <code>BaseTo</code> и <code>AbstractBaseEntity</code></li>
            <li>Сделал проверку <code>id</code> в <code>ValidationUtil</code> на основе <code>HasId</code></li>
            <li>Сделал в <code>ProfileRestController</code> обновление своего профиля через <code>UserTo</code> (нельзя изменять себе роли) и поправил тест</li>
        </ul>
    </blockquote>
    <h3>
        <a id="user-content--5--spring-validation" class="anchor" aria-hidden="true" href="#-5--spring-validation">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 5.  <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFLXp5MTFDMEY5WFE" rel="nofollow">Spring Validation</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_06_validationpatch" class="anchor" aria-hidden="true" href="#apply-9_06_validationpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_06_validation.patch
    </h4>
    <blockquote>
        <ul>
            <li><code>responseJSON</code> не выводится в случае его отсутствия (например при попытке добавить пользователя с дублирующимся email)</li>
        </ul>
    </blockquote>
    <ul>
        <li><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#validation-beanvalidation" rel="nofollow">Spring Validation.</a></li>
        <li><a href="http://beanvalidation.org/" rel="nofollow">Bean Validation</a></li>
        <li><a href="https://spring.io/blog/2012/08/29/integrating-spring-mvc-with-jquery-for-validation-rules" rel="nofollow">Валидация формы по AJAX.</a></li>
        <li><a href="http://stackoverflow.com/questions/14730329/jpa-2-0-exception-to-use-javax-validation-package-in-jpa-2-0#answer-17142416" rel="nofollow">JSR-303, 349</a></li>
        <li><a href="https://dzone.com/articles/spring-31-valid-requestbody" rel="nofollow">@Valid @RequestBody + Error handling</a></li>
        <li><a href="https://www.baeldung.com/javax-validation" rel="nofollow">Java Bean Validation Basics</a></li>
    </ul>
    <h3>
        <a id="user-content--6--перевод-datatables-на-ajax" class="anchor" aria-hidden="true" href="#-6--перевод-datatables-на-ajax">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 6.  <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFcW1qeTVFdS1BdHM" rel="nofollow">Перевод DataTables на Ajax</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_07_datatable_via_ajaxpatch" class="anchor" aria-hidden="true" href="#apply-9_07_datatable_via_ajaxpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_07_datatable_via_ajax.patch
    </h4>
    <blockquote>
        <ul>
            <li>Перешли на <a href="https://datatables.net/upgrade/1.10-convert" rel="nofollow">параметры Datatables в формате 1.10</a></li>
            <li>В <code>makeEditable()</code> больше нет манипуляций c DOM, которые требуются делать ПОСЛЕ отработки плагина <code>datatable</code>, поэтому нам не обязательно вызывать ее в коллбэке <code>initComplete</code>.</li>
        </ul>
    </blockquote>
    <ul>
        <li><a href="https://datatables.net/manual/ajax" rel="nofollow">DataTables Ajax</a></li>
    </ul>
    <h4>
        <a id="user-content--вопрос-1" class="anchor" aria-hidden="true" href="#-вопрос-1">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png" alt="question" style="max-width:100%;"></a> Вопрос:
    </h4>
    <blockquote>
        <p>Что за дополнительный параметр (который каждый раз инкрементируется) появляется при запросе datatables данных по ajax (например <code>http://localhost:8080/topjava/ajax/admin/users/?_=1496156621129</code>) ?</p>
    </blockquote>
    <p>Это защита <code>datatables</code> от кэширования запроса браузером. При изменении js, css и других статический ресурсов, также полезно добавлять в запрос версию, чтобы данные не брались из кэша (особенно когда приложение уже вышло в продакшен).</p>
    <h4>
        <a id="user-content-apply-9_08_js_i18npatch" class="anchor" aria-hidden="true" href="#apply-9_08_js_i18npatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_08_js_i18n.patch
    </h4>
    <blockquote>
        <ul>
            <li>
                Добавил <a href="https://stackoverflow.com/questions/6218970/resolving-springmessages-in-javascript-for-i18n-internationalization" rel="nofollow">простую интернационализацию в JavaScript</a>.
                <ul>
                    <li>на стороне сервера формируется <code>i18n</code> JavaScript массив с значениями, который затем используется для интернационализации в браузере</li>
                    <li>в модальном окне заголовок подменяется через <code>$('#modalTitle').html(..title)</code></li>
                </ul>
            </li>
        </ul>
    </blockquote>
    <blockquote>
        <p>Для тестирования локали</p>
        <ul>
            <li><a href="https://stackoverflow.com/questions/7769061/how-to-add-custom-accept-languages-to-chrome-for-pseudolocalization-testing" rel="nofollow">можно поменять <code>Accept-Language</code></a>. Для хрома в <code>chrome://settings/languages</code> перетащить нужную локаль наверх.</li>
            <li>можно поставить <a href="https://chrome.google.com/webstore/detail/locale-switcher/kngfjpghaokedippaapkfihdlmmlafcc" rel="nofollow">Locale Switcher</a> хром плагин</li>
        </ul>
    </blockquote>
    <ul>
        <li><a href="http://stackoverflow.com/a/6242840/548473" rel="nofollow">JavaScript internationalization</a></li>
    </ul>
    <h3>
        <a id="user-content--7--форма-логина--логаут" class="anchor" aria-hidden="true" href="#-7--форма-логина--логаут">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 7.  <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFUmhUTms1WnhTeHc" rel="nofollow">Форма логина / логаут.</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_09_min_form_loginpatch" class="anchor" aria-hidden="true" href="#apply-9_09_min_form_loginpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_09_min_form_login.patch
    </h4>
    <blockquote>
        <p>Добавил функциональность logout</p>
    </blockquote>
    <ul>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#ns-minimal" rel="nofollow">Минимальный form-login</a></li>
        <li><a href="https://docs.spring.io/spring-security/site/migrate/current/3-to-4/html5/migrate-3-to-4-xml.html#m3to4-xmlnamespace-form-login" rel="nofollow">Migrating &lt;form-login&gt;</a></li>
    </ul>
    <h4>
        <a id="user-content--мои-вопросы" class="anchor" aria-hidden="true" href="#-мои-вопросы">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png" alt="question" style="max-width:100%;"></a> Мои вопросы:
    </h4>
    <ul>
        <li>Почему при логине как admin еда отдаются для user?</li>
        <li>Почему при логине как user не отображается список пользователей?</li>
        <li>Почему еда не редактируется?</li>
    </ul>
    <blockquote>
        <p>Подсказка: поглядите вкладку Network в браузере.</p>
    </blockquote>
    <h4>
        <a id="user-content-apply-9_10_jsp_form_loginpatch" class="anchor" aria-hidden="true" href="#apply-9_10_jsp_form_loginpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_10_jsp_form_login.patch
    </h4>
    <blockquote>
        <p>Рефакторинг</p>
        <ul>
            <li>В <code>login.jsp</code> вместо атрибутов достаю параметры запроса (<code>param.error/message</code>).</li>
            <li>Сделал i18n описания приложения</li>
            <li>При нажатии кнопок <code>Зайти как ...</code> сделал вход в приложение</li>
        </ul>
    </blockquote>
    <ul>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#ns-form-and-basic" rel="nofollow">Собственный form-login</a></li>
    </ul>
    <h3>
        <a id="user-content--8-реализация-собственного-провайдера-авторизации" class="anchor" aria-hidden="true" href="#-8-реализация-собственного-провайдера-авторизации">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 8. <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFYTA4aVN4bWxzbEU" rel="nofollow">Реализация собственного провайдера авторизации.</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_11_auth_via_user_servicepatch" class="anchor" aria-hidden="true" href="#apply-9_11_auth_via_user_servicepatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_11_auth_via_user_service.patch
    </h4>
    <blockquote>
        <p>В <code>UserService</code> добавил <code>@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)</code>, т.к. без этой аннотации для кэширования создается прокси над интерфейсом <code>UserDetailsService</code> (см. следующее видео по типам проксирования Spring). Можете проверить, что без этой аннотации приложение не поднимется.
            <code>GrantedAuthority</code> это "разрешение" или "право". Если оно дается на основе роли, в Spring Security принято использовать префикс <code>ROLE_</code>. При этом сама роль не должна иметь префикс.
        </p>
        <ul>
            <li><a href="https://stackoverflow.com/a/19542316/548473" rel="nofollow">Role and GrantedAuthority</a></li>
        </ul>
    </blockquote>
    <ul>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#userdetailsservice-implementations" rel="nofollow">UserDetailsService Implementations</a></li>
        <li><a href="https://stackoverflow.com/a/605832/548473" rel="nofollow">serialVersionUID value</a></li>
    </ul>
    <h3>
        <a id="user-content--9--принцип-работы-spring-security-проксирование" class="anchor" aria-hidden="true" href="#-9--принцип-работы-spring-security-проксирование">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 9.  <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFT2Qya2V4N0kzWWM" rel="nofollow">Принцип работы Spring Security. Проксирование.</a>
    </h3>
    <ul>
        <li><a href="https://ru.wikibooks.org/wiki/Spring_Security/Технический_обзор_Spring_Security" rel="nofollow">Технический обзор Spring Security</a></li>
        <li><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/core.html#aop-proxying" rel="nofollow">Типы проксирования</a></li>
        <li><a href="http://samolisov.blogspot.ru/2010/04/proxy-java.html" rel="nofollow">Dynamic Proxy API</a></li>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#filter-stack" rel="nofollow">Security фильтры</a></li>
        <li><a href="https://www.youtube.com/watch?v=7uxROJ1nduk" rel="nofollow">Основы работы с Spring Security от Eugene Suleimanov</a></li>
    </ul>
    <h3>
        <a id="user-content--10-spring-security-test" class="anchor" aria-hidden="true" href="#-10-spring-security-test">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 10. <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFU3hMR0o4eGNoUmc" rel="nofollow">Spring Security Test</a>
    </h3>
    <h4>
        <a id="user-content-apply-9_12_spring_security_testpatch" class="anchor" aria-hidden="true" href="#apply-9_12_spring_security_testpatch">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Apply 9_12_spring_security_test.patch
    </h4>
    <blockquote>
        <ul>
            <li>Cделал "честную" авторизацию в <code>RootControllerTest</code> (через <code>authentication</code> в утильном методе <code>TestUtil</code>)</li>
            <li>Cделал <code>mockAuthorize</code> для <code>SpringMain</code>, в который не попадают фильтры</li>
        </ul>
    </blockquote>
    <ul>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#test" rel="nofollow">Spring Security Test</a></li>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#test-mockmvc" rel="nofollow">Интеграция со Spring MVC Test</a></li>
        <li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#testing-http-basic-authentication" rel="nofollow">HttpBasic авторизация</a></li>
        <li><a href="http://habrahabr.ru/post/171911/" rel="nofollow">Тестирование контроллеров с помощью MockMvc (без spring-security-test)</a></li>
    </ul>
    <h3>
        <a id="user-content--11-cookie-session" class="anchor" aria-hidden="true" href="#-11-cookie-session">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 11. <a href="https://drive.google.com/open?id=0B9Ye2auQ_NsFUzNFanF6MGZGNHc" rel="nofollow">Cookie. Session.</a>
    </h3>
    <ul>
        <li><a href="https://ru.wikipedia.org/wiki/HTTP_cookie" rel="nofollow">HTTP cookie</a></li>
        <li><a href="http://stackoverflow.com/questions/595872/under-what-conditions-is-a-jsessionid-created" rel="nofollow">Under what conditions is a JSESSIONID created?</a></li>
        <li><a href="http://halyph.blogspot.ru/2014/08/how-to-disable-tomcat-session.html" rel="nofollow">Tomcat Session Serialization</a></li>
    </ul>
    <h3>
        <a id="user-content-дополнительно--12-новое-в-spring-5-миграция-проекта" class="anchor" aria-hidden="true" href="#дополнительно--12-новое-в-spring-5-миграция-проекта">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Дополнительно: <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672715/06dbc6ce-e6e7-11e5-81a9-04fbddb9e488.png" alt="video" style="max-width:100%;"></a> 12. <a href="https://javaops.ru/view/resources/spring5" rel="nofollow">Новое в Spring 5. Миграция проекта</a>
    </h3>
    <h2>
        <a id="user-content--ваши-вопросы" class="anchor" aria-hidden="true" href="#-ваши-вопросы">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672858/9cd58692-e6e7-11e5-905d-c295d2a456f1.png" alt="question" style="max-width:100%;"></a> Ваши вопросы
    </h2>
    <blockquote>
        <p>В куки попадает обычная строка JSESSIONID. Куда сериализуется объект User?</p>
    </blockquote>
    <p>Для хранения состояния сессии (например корзины покупателя) в Servlet API есть механизм хранения объектов сессии (грубо - мультимапмапа, которая достается из хранилища по ключу). При создании сессии на стороне сервера (через <code>request.getSession</code>) создается кука <code>JSESSIONID</code>, которая передается между клиентом и сервером в каждом запросе и является ключом в хранилище объектов сессий. См. <a href="http://javatutor.net/books/tiej/servlets#_Toc39472970" rel="nofollow">обработка сессий с помощью сервлетов</a></p>
    <blockquote>
        <p>В <code>login.jsp</code> есть форма <code>&lt;form:form action="spring_security_check" ..&gt;</code> Где такой url используется?</p>
    </blockquote>
    <p>Это стандартный url для авторизации в <code>spring-security</code>. Он его и обрабатывает.</p>
    <blockquote>
        <p>Если не пользовать js, а писать UI на JSP, сообщения между ui и сервером будут в формате json? Это же будет JSON API?</p>
    </blockquote>
    <p>Есть данные, которые передаются между клиентом и сервером в формате json или get/post с параметрами, есть стили взаимодействия клиента и сервера (<a href="https://ru.wikipedia.org/wiki/REST" rel="nofollow">REST</a>, <a href="http://jsonapi.org/" rel="nofollow">JSON API</a>, <a href="https://ru.wikipedia.org/wiki/JSON-RPC" rel="nofollow">JSON-RPC</a>) и есть средства генерации HTML: JSP, Javascript фреймворк, Thymleaf и пр. Не надо эти вещи путать между собой.</p>
    <blockquote>
        <p>По умолчанию спринг работает с <code>UserDetailsService</code>, который должен возвращать <code>UserDetails</code>. Но мы не хотим стандартные, мы хотим свои, поэтому просто наследуем наши <code>UserService</code> и <code>AuthorizedUser</code> от соответствующих интерфейсов и реализуем недостающие методы, которые spring security и будет использовать?</p>
    </blockquote>
    <p>Да. Сервис аутентификации конфигурируется в <code>spring-security.xml</code> <code>&lt;authentication-manager&gt;</code> и должен реализовывать интерфейс <code>UserDetailsService</code>. В spring-security есть его стандартные реализации, которые использовались до нашей кастомной <code>UserService</code>, например <code>jdbc-user-service</code> использует реализацию <code>JdbcUserDetailsManager</code></p>
    <h2>
        <a id="user-content--домашнее-задание-hw9" class="anchor" aria-hidden="true" href="#-домашнее-задание-hw9">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672719/09593080-e6e7-11e5-81d1-5cb629c438ca.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672719/09593080-e6e7-11e5-81d1-5cb629c438ca.png" alt="hw" style="max-width:100%;"></a> Домашнее задание HW9
    </h2>
    <ul>
        <li>1: Реализовать для meal Binding/ Update/ Validation. Проверить работу при пустом значении <code>calories</code>.</li>
        <li>2: Перевести <code>meals.jsp</code> на работу по ajax. Стиль строки таблицы сделать в зависимости от <code>excess</code>, время отображать без <code>T</code>. Добавить i18n.</li>
        <li>3: Починить meals тесты, добавить тест на неавторизованный доступ</li>
    </ul>
    <h3>
        <a id="user-content-optional" class="anchor" aria-hidden="true" href="#optional">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Optional
    </h3>
    <ul>
        <li>
            <p>4: Подключить datetime-picker к фильтрам и модальному окну добавления/редактирования еды</p>
            <ul>
                <li><a href="http://xdsoft.net/jqplugins/datetimepicker/" rel="nofollow">DateTimePicker jQuery plugin</a></li>
                <li><a href="https://jquery-docs.ru/jQuery.ajax/#using-converters" rel="nofollow">jQuery: конверторы</a></li>
            </ul>
        </li>
        <li>
            <p>Попробуйте при запросах по REST оставить стандартный ISO формат (с разделителем <code>T</code>). То есть:</p>
            <ul>
                <li>Отображение и редактирование еды на UI происходит без <code>T</code> (формат значений на UI можно увидеть во вкладке браузера Network)</li>
                <li>Когда мы работаем по REST, в json и запросах формат даты ISO (с разделителем <code>T</code>)</li>
                <li>Напомню, что параметры методов контроллера (в том числе собранные в объекты через Binding) парсятся конверторами спринга (<code>@DateTimeFormat</code>), а объекты json парсится Jackson и они никак не влияют друг на друга.</li>
            </ul>
        </li>
    </ul>
    <h2>
        <a id="user-content--проверка-в-hw09" class="anchor" aria-hidden="true" href="#-проверка-в-hw09">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672935/ef09ec1e-e6e7-11e5-9f79-d1641c05cbe6.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672935/ef09ec1e-e6e7-11e5-9f79-d1641c05cbe6.png" alt="error" style="max-width:100%;"></a> Проверка в HW09
    </h2>
    <ul>
        <li>1: Проверьте, что при добавлении и редактировании пользователя и еды у вас корректно отображаются заголовки модального окна:
            "Добавить/Редактировать еду пользователя"
        </li>
        <li>2: Не дублируйте</li>
    </ul>
    <pre><code>&lt;c:forEach var='key' ...
i18n['${key}'] = ...
</code></pre>
    <ul>
        <li>3: Для подключения css и js datetimepicker-а посмотрите в его jar (или поищите в проекте по Ctrl+Shift+N: <code>datetimepicker</code>).
            При ошибке в datetimepicker javascript, обратите внимание на <strong>имя javascript файла</strong> в <a href="https://xdsoft.net/jqplugins/datetimepicker/" rel="nofollow">DateTimePicker</a> "How do I use it?"
        </li>
        <li>4: datetimepicker работает корректно в Хроме, если убрать в <code>type</code> в <code>&lt;input type="date/time/datetime-local" ..</code></li>
        <li>5: Если появляются проблемы с JS типа <code>... is not defined</code> - обратите внимание на порядок загрузки скриптов и атрибут <code>defer</code>. Скрипты должны идти в нужном порядке. Если определяете скрипт прямо в jsp, он выполняется до <code>defer</code> скриптов.</li>
        <li>6: Не дублируйте обработку ошибок в <code>BindingResult</code> в ajax контроллерах</li>
        <li>7: Проверьте редактирование еды: открыть на редактирование и сохранить не должно приводить к ошибкам с форматом времени.</li>
        <li>8: Проверьте в <code>RootController.meals()</code>, его нужно тоже поправить</li>
        <li>9: При решении с jQuery конвертором: он создает поле <code>responseJSON</code>, если внутри не вылетает по эксепшену. См. также <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty" rel="nofollow">hasOwnProperty()</a></li>
    </ul>
</article>