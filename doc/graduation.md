<article class="markdown-body entry-content container-lg" itemprop="text">
    <h2>
        <a id="user-content-выпускной-проект-topjava" class="anchor" aria-hidden="true" href="#выпускной-проект-topjava">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Выпускной проект Topjava
    </h2>
    <ul>
        <li>Ревью проекта входит в участие с проверкой домашних заданий. Проверяется <strong>два</strong> раза: один раз ассистентами и после ваших правок - финальная проверка, Кислиным Григорием. Ревью выпускного делается только у участников с проверкой ДЗ. У кого оплачен Диплом, но нет проверки - даю краткие итоги.</li>
        <li>Отдать выпускной на ревью нужно до 16.05. Участникам проекта <a href="http://javaops.ru/reg/masterjava" rel="nofollow">Многомодульный maven. Многопоточность. XML (JAXB/StAX). Веб сервисы (JAX-RS/SOAP). Удаленное взаимодействие (JMS/AKKA) (Masterjava)</a> срок до 16.08.2021.</li>
        <li><strong>Ревью выпускного можно оплатить отдельно как <a href="https://javaops.ru/auth/payonline?payId=I" rel="nofollow">техническое собеседование</a></strong></li>
        <li><strong><a href="https://docs.google.com/forms/d/1G8cSGBfXIy9bNECo6L-tkxWQYWeVhfzR7te4b-Jwn-Q" rel="nofollow">После выполнения выпускного заполните форму</a></strong></li>
        <li>Заключившим образовательный договор: <strong>для получение диплома требуется сдача выпускного проекта (либо любого другого, даже рабочего, на нашем стеке)</strong>. В случае, если Вы его не успеете его сделать, <strong>заранее оформляется академический отпуск</strong>.</li>
    </ul>
    <hr>
    <p>Design and implement a REST API using Hibernate/Spring/SpringMVC (or Spring-Boot) <strong>without frontend</strong>.</p>
    <p>The task is:</p>
    <p>Build a voting system for deciding where to have lunch.</p>
    <ul>
        <li>2 types of users: admin and regular users</li>
        <li>Admin can input a restaurant and it's lunch menu of the day (2-5 items usually, just a dish name and price)</li>
        <li>Menu changes each day (admins do the updates)</li>
        <li>Users can vote on which restaurant they want to have lunch at</li>
        <li>Only one vote counted per user</li>
        <li>
            If user votes again the same day:
            <ul>
                <li>If it is before 11:00 we assume that he changed his mind.</li>
                <li>If it is after 11:00 then it is too late, vote can't be changed</li>
            </ul>
        </li>
    </ul>
    <p>Each restaurant provides a new menu each day.</p>
    <p>As a result, provide a link to github repository. It should contain the code, README.md with API documentation and couple curl commands to test it.</p>
    <hr>
    <p>P.S.: Make sure everything works with latest version that is on github :)</p>
    <p>P.P.S.: Assume that your API will be used by a frontend developer to build frontend on top of that.</p>
    <hr>
    <h3>
        <a id="user-content--рекомендации" class="anchor" aria-hidden="true" href="#-рекомендации">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        <a target="_blank" rel="noopener noreferrer" href="https://cloud.githubusercontent.com/assets/13649199/13672935/ef09ec1e-e6e7-11e5-9f79-d1641c05cbe6.png"><img src="https://cloud.githubusercontent.com/assets/13649199/13672935/ef09ec1e-e6e7-11e5-9f79-d1641c05cbe6.png" alt="error" style="max-width:100%;"></a> Рекомендации
    </h3>
    <ul>
        <li><strong>Не списывайте! У каждого проекта есть "лицо". Такие проекты пишут только наши выпускники, и их репозитории есть в нашей базе. Поэтому при подозрениях на списывание оригинал вычисляется легко. Лучше написать свое - как можете, как поняли материал - и получить ревью (которое вами же оплачено) своего проекта, а не чужого. Даже если времени мало - сделайте основное. Если с Дипломом - это с очень большой вероятностью 4, вместо отчисления</strong></li>
        <li><strong>Сделай новый проект и добавляй туда из Topjava только то что нужно! Локализация, типы ошибок, BeanMatcher, Json View, излишние делегирования и наследования - не нужны!</strong></li>
        <li><strong>API продумывай с точки зрения не программиста и объектов, а с точки зрения того, кто им будет пользоваться (frontend). Еще раз - в рамках ТЗ!</strong></li>
        <li><strong>Сначала сделай основной сценарий по ТЗ. Все остальное (если очень хочется, 3 раза подумай) - потом.</strong></li>
    </ul>
    <p><em>Представьте себе, что ПМ (лид, архитектор) дал вам ТЗ и некоторое время недоступен. У вас, конечно, есть много мыслей, для чего нужно приложение, как исправить ТЗ, дополнить его и сделать правильно. НО НЕ НАДО ИХ РЕАЛИЗОВЫВАТЬ В КОДЕ. Нужно сделать все максимально просто, удобно для доработок и для использования со стороны клиента (если, конечно, в ТЗ нет оговорок). Все свои вопросы, предложения и хотелки оформляйте отдельно (в <code>read.me</code> например). Если делаете что-то сложнее простейшего случая (например, справочник еды) - обязательно напишите в read.me. Как и выбор стратегии кэширования.</em></p>
    <blockquote>
        <p>Совершенство достигнуто не тогда, когда нечего добавить, а тогда, когда нечего отнять</p>
    </blockquote>
    <p><em>Антуан де Сент-Экзюпери</em></p>
    <ul>
        <li>1: <strong>читаем ТЗ ОЧЕНЬ внимательно, НЕ надо ничего своего туда домысливать и творчески изменять</strong></li>
        <li>2: <strong>тщательно считайте количество обращений в базу на каждый запрос. Особенно при запросах от юзеров, которых очень много! Также на сложность запросов от них, чтобы не положить базу</strong></li>
        <li>3: <strong>тщательно считайте количество запросов в вашем API для отображения нужной информации</strong></li>
        <li>4: учитывайте, что <strong>пользователей может быть ОООЧЕНЬ много, а админов - МАЛО</strong></li>
        <li>
            5: в проекте (и тестовом задании на работу), в отличие от нашего учебного topjava, оставляйте только необходимый для работы приложения код, ничего лишнего:
            <ul>
                <li>5.1 НЕ надо делать разные профили базы и работы с ней</li>
                <li>5.2 НЕ надо делать абстрактных контроллеров на всякий случай</li>
                <li>5.3 НЕ надо делать <strong>классов репозиториев и сервисов</strong>, если там нет ничего, кроме делегирования</li>
                <li>5.4 Из потребностей приложения (которую надо самим придумать) реализовывать только очевидные сценарии. То есть НИЧЕГО ЛИШНЕГО.</li>
            </ul>
        </li>
        <li>
            6: База Данных
            <ul>
                <li>берите без установки (H2 или HSQLDB). Одну!! Ваше приложение должно сразу запуститься, <strong>без всяких настроек и переменных окружения</strong></li>
                <li>сделайте индексы к таблицам. Попробуйте обеспечит UNIQUE (один голос пользователя в день, один уникальный пункт меню в день). Следите за порядком полей в индексе</li>
                <li><strong>историю еды и голосований сделать НУЖНО! Есть базовые вещи, которые закладываются в архитектуру приложения и неочевидные доработки к ТЗ, которых лучше не делать.</strong></li>
            </ul>
        </li>
        <li>7: по возможности сделать JUnit тесты</li>
        <li>8: уделяйте внимание обработке ошибок</li>
        <li>
            9: делаем REST API в соответствии с концепцией REST (url в общем имеют вид<code>{ресурс}/{id_ресурсa}[/{подресурс}/{id_подресурсa}][параметры]</code>)
            <ul>
                <li><strong><a href="https://habrahabr.ru/company/yandex/blog/265569/" rel="nofollow">15 тривиальных фактов о правильной работе с протоколом HTTP</a></strong></li>
                <li><strong><a href="https://medium.com/@mwaysolutions/10-best-practices-for-better-restful-api-cbe81b06f291" rel="nofollow">10 Best Practices for Better RESTful API</a></strong></li>
                <li><a href="https://stackoverflow.com/questions/20951419/what-are-best-practices-for-rest-nested-resources" rel="nofollow">REST resource hierarchy</a></li>
            </ul>
        </li>
        <li>10: не смешивайте TO и Entity вместе. Лучше всего, если они будут независимыми друг от друга.</li>
        <li>11: не размещайте логику приложения и преобразования в TO в слое доступа к DB</li>
        <li>12: если приложению в объекте требуется только его id, используйте reference (как мы при сохранении еды вставляем туда юзера)</li>
        <li>13: <a href="http://stackoverflow.com/a/43051227/548473" rel="nofollow">Use for money in java app</a></li>
        <li>14: еще раз про <a href="https://stackoverflow.com/questions/5031614/the-jpa-hashcode-equals-dilemma" rel="nofollow">hashCode/equals в Entity</a>: не делайте сравнение по полям!</li>
        <li>15: название пакетов, имен классов для <code>model/to/web</code> достаточно стандартные (например <code>model/domain</code>). НЕ надо придумывать своих собственных правил</li>
        <li>16: <strong>Используйте DATA-JPA</strong> (можно без лишней делегации, напрямую из сервиса/контроллера дергать Repository)</li>
        <li>17: в DATA-JPA 2.x используются <code>Optional</code>. Попробуйте работать с ними, это безопасный способ работать с null значениями (используйте <code>orElseThrow</code>)</li>
        <li>18: на topjava мы смотрели разные варианты использования, тут делаем максимально просто. С TO многие вещи упрощаются</li>
        <li>19: проверьте, не торчат ли из кода учебные уши topjava, типа <code>ProfileRestController.testUTF()</code>, <code>AbstractServiceTest.printResult()</code> или закомментированные <code>JdbcTemplate</code>. Назначение этого проекта совсем другое</li>
        <li>20: ORM работает с объектами. <a href="https://stackoverflow.com/questions/6311776/hibernate-foreign-keys-instead-of-entities" rel="nofollow">В простейших случаях fk_id как поля допустимы</a>, но при этом JPA их уже никак не обрабатывает и не используйте их вместе с объектами.  Ссылка на stackoverflow в коде обязательна!</li>
        <li>21: проверьте, станет ли код проще с <code>@AuthenticationPrincipal</code> (урок 11, Доступ к AuthorizedUser).</li>
        <li>22: обновление в базе делается через <code>update</code>,  даже если <code>delete/insert</code> сократит java код на несколько строк</li>
        <li>
            23: Кэширование
            <ul>
                <li>необязательно, но желательно</li>
                <li><strong>тщательно продумайте, что надо кэшировать (самые частые запросы)</strong>, а что нет (большие или редко запрашиваемые данные)!</li>
                <li>проверьте соответствие ключей к кэшу (параметры кэшируемого метода) с конфигурацией (например в singleNonExpiryCache, heap=1 в кэше может содержаться только ОДНО значение).</li>
            </ul>
        </li>
        <li>
            24: Валидация
            <ul>
                <li>желательна</li>
                <li>одних аннотаций недостаточно. Должны быть <code>@Valid/@Validation</code></li>
                <li>проверяйте входные данные при <code>create/update</code> в контроллерах! В TopJava это <code>ValidationUtil.checkNew()/assureIdConsistent()</code></li>
            </ul>
        </li>
        <li>
            25: <code>readme.md</code>:
            <ul>
                <li>Если задание на English, описание пишите также на English (тоже самое относится к языку резюме: вакансия на English предполагает ваше резюме на English)</li>
                <li>Требуемые примеры <code>curl</code> не прячьте, а пишите здесь!</li>
                <li>Проверяют люди с опытом в Java: не надо писать инструкций, как устанавливать Java и Maven:)</li>
            </ul>
        </li>
    </ul>
    <h2>
        <a id="user-content-попробуйте-подергать-свое-api-по-всем-типичным-сценариям-тз" class="anchor" aria-hidden="true" href="#попробуйте-подергать-свое-api-по-всем-типичным-сценариям-тз">
            <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true">
                <path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path>
            </svg>
        </a>
        Попробуйте подергать свое API по всем типичным сценариям ТЗ!
    </h2>
    <ul>
        <li>Удобно использовать? Можно сделать проще? Например чтобы проголосовать за ресторан залогиненному юзеру достаточно <code>restorauntId</code>.</li>
        <li>Сколько раз пришлось его вызвать API для типичного сценария (нарпимер посмотреть рестораны с едой)?</li>
        <li>Сколько запросов к базе было сделано? Можно ли сократить (например с FETCH/Graph или через кэширование)?</li>
        <li><strong>API ДОЛЖНО соответствовать принципам REST (см. ссылки выше)</strong></li>
        <li><strong>ОБЯЗАТЕЛЬНО: запустите <code>mvn test</code> - ошибок быть не должно</strong></li>
        <li><strong>ОБЯЗАТЕЛЬНО: запустите приложение без всяких предварительных настроек (базы, переменных окружения, ..), лучше на другом компьютере. Должно запускаться!</strong></li>
    </ul>
</article>